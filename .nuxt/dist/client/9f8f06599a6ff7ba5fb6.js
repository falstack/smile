(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{227:function(e,t,n){"use strict";n(35),n(54),n(55),n(32),n(104),n(105),n(76),n(10),n(34),n(75),n(106),n(33),n(77);var o=n(56),r=(n(36),n(6)),l=n(228);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}t.a={data:function(){return{imageUploadToken:"",imageUploadAccept:["jpeg","png","jpg"],imageUploadAction:"https://upload.qiniup.com",imagePrefix:"https://m1.calibur.tv/"}},computed:{currentUser:function(){return this.$store.state.user},isAuth:function(){return this.$store.state.isAuth}},mounted:function(){var e=this;this.isAuth?this.initUpToken():this.$channel.$when("user-signed",(function(){e.initUpToken()}))},beforeDestroy:function(){this.getUpTokenTimer&&clearInterval(this.getUpTokenTimer)},methods:{initUpToken:function(){var e=this;this.getUpToken(),this.getUpTokenTimer=setInterval((function(){e.getUpToken()}),18e5)},getUpToken:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(l.a)(e);case 2:e.imageUploadToken=t.sent;case 3:case"end":return t.stop()}}),t)})))()},imageUploadRequest:function(data){var e,t,n;return data.key=(e={slug:this.currentUser.slug,file:data.file},t=e.slug,n=e.file,"".concat(t,"/").concat((new Date).getTime(),"-").concat(Math.random().toString(36).substring(3,6),".").concat(n.type.split("/").pop())),data.token=this.imageUploadToken,data},imageUploadResponse:function(e){try{return function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({},e.data,{url:"".concat(this.imagePrefix).concat(e.data.url)})}catch(e){return{}}}}}},228:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return r}));n(54),n(10),n(75);var o=function(e){return e.$axios.$get("v1/image/uptoken")},r=function(e,t){return e.$axios.$post("https://up.qbox.me",t,{"Content-Type":"multipart/form-data"})}},234:function(e,t,n){"use strict";t.a={beforeMount:function(){var e=this;this.$channel.$when("user-not-sign",(function(){e.$toast.error("继续操作前请先登录").then((function(){e.$bridge.redirectTo({url:"/pages/user/login/index?from=".concat(encodeURIComponent(window.location.href))})}))}))}}},266:function(e,t,n){var content=n(340);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(24).default)("5f81af62",content,!0,{sourceMap:!1})},267:function(e,t,n){var content=n(342);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(24).default)("5328f2de",content,!0,{sourceMap:!1})},268:function(e,t,n){var content=n(344);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(24).default)("3b9fe632",content,!0,{sourceMap:!1})},269:function(e,t,n){var content=n(346);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(24).default)("6b8266a3",content,!0,{sourceMap:!1})},315:function(e,t,n){var content=n(316);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(24).default)("4f9463e2",content,!0,{sourceMap:!1})},316:function(e,t,n){(t=n(23)(!1)).push([e.i,"@keyframes skeleton-loading{0%{background-position:100% 50%}to{background-position:0 50%}}@-webkit-keyframes skeleton-loading{0%{background-position:100% 50%}to{background-position:0 50%}}@keyframes skeleton{0%{width:60%}50%{width:100%}to{width:60%}}@-webkit-keyframes skeleton{0%{width:60%}50%{width:100%}to{width:60%}}.ce-header{padding:10px 0;margin:0;line-height:1.5em;outline:none}.ce-header div,.ce-header p{padding:0!important;margin:0!important}.ce-header[contentEditable=true][data-placeholder]:before{position:absolute;content:attr(data-placeholder);color:#707684;font-weight:400;opacity:0}.ce-header[contentEditable=true][data-placeholder]:empty:before{opacity:1}.ce-header[contentEditable=true][data-placeholder]:empty:focus:before{opacity:0}",""]),e.exports=t},317:function(e,t,n){var content=n(318);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(24).default)("70e8b928",content,!0,{sourceMap:!1})},318:function(e,t,n){(t=n(23)(!1)).push([e.i,"@keyframes skeleton-loading{0%{background-position:100% 50%}to{background-position:0 50%}}@-webkit-keyframes skeleton-loading{0%{background-position:100% 50%}to{background-position:0 50%}}@keyframes skeleton{0%{width:60%}50%{width:100%}to{width:60%}}@-webkit-keyframes skeleton{0%{width:60%}50%{width:100%}to{width:60%}}.baidu-resource{padding:.7em 0}.baidu-resource-wrap{overflow:hidden;padding:15px;background-color:#fff;border:1px solid rgba(201,201,204,.48);box-shadow:0 1px 3px rgba(0,0,0,.1);border-radius:6px}.baidu-resource-password,.baidu-resource-url{display:block;width:100%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;border:1px solid rgba(201,201,204,.48);box-shadow:inset 0 1px 2px 0 rgba(35,44,72,.06);border-radius:3px;padding:10px 12px;margin-bottom:20px}.baidu-resource-role-wrap{color:#99a2aa}.baidu-resource-label{margin-right:20px;margin-left:5px;cursor:pointer}",""]),e.exports=t},323:function(e,t,n){var content=n(324);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(24).default)("f4d1cbfa",content,!0,{sourceMap:!1})},324:function(e,t,n){(t=n(23)(!1)).push([e.i,'@keyframes skeleton-loading{0%{background-position:100% 50%}to{background-position:0 50%}}@-webkit-keyframes skeleton-loading{0%{background-position:100% 50%}to{background-position:0 50%}}@keyframes skeleton{0%{width:60%}50%{width:100%}to{width:60%}}@-webkit-keyframes skeleton{0%{width:60%}50%{width:100%}to{width:60%}}.embed-tool iframe{margin:0 auto;display:block}.editor-video-wrap{position:relative;width:100%;height:0;padding-top:60%}.editor-video-wrap iframe{position:absolute;left:0;top:0;width:100%;height:100%}.embed-tool--loading .embed-tool__caption{display:none}.embed-tool--loading .embed-tool__preloader{display:block}.embed-tool--loading .embed-tool__content{display:none}.embed-tool__preloader{display:none;position:relative;height:200px;box-sizing:border-box;border-radius:5px;border:1px solid #e6e9eb}.embed-tool__preloader:before{content:"";position:absolute;z-index:3;left:50%;top:50%;width:30px;height:30px;margin-top:-25px;margin-left:-15px;border-radius:50%;border:2px solid #cdd1e0;border-top-color:#ff6881;box-sizing:border-box;-webkit-animation:embed-preloader-spin 2s linear infinite;animation:embed-preloader-spin 2s linear infinite}.embed-tool__url{position:absolute;bottom:20px;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);max-width:250px;color:#7b7e89;font-size:11px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.embed-tool__caption{margin-top:7px;display:inline-block;position:relative;width:auto!important;left:50%!important;-webkit-transform:translateX(-50%)!important;transform:translateX(-50%)!important;text-align:center!important;box-shadow:none!important;border-top-width:0!important;border-left-width:0!important;border-right-width:0!important;border-radius:0!important;min-width:115px!important;border-color:#e7e7e7}.embed-tool__caption:before{left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.embed-tool__caption[contentEditable=true][data-placeholder]:before{position:absolute!important;content:"视频描述";color:#707684;font-weight:400;width:auto;opacity:0}.embed-tool__caption[contentEditable=true][data-placeholder]:empty:before{opacity:1}.embed-tool__caption[contentEditable=true][data-placeholder]:empty:focus:before{opacity:0}@-webkit-keyframes embed-preloader-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes embed-preloader-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}',""]),e.exports=t},326:function(e,t,n){var content=n(327);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(24).default)("a4606c00",content,!0,{sourceMap:!1})},327:function(e,t,n){var o=n(23),r=n(328),l=n(329);t=o(!1);var c=r(l);t.push([e.i,"@keyframes skeleton-loading{0%{background-position:100% 50%}to{background-position:0 50%}}@-webkit-keyframes skeleton-loading{0%{background-position:100% 50%}to{background-position:0 50%}}@keyframes skeleton{0%{width:60%}50%{width:100%}to{width:60%}}@-webkit-keyframes skeleton{0%{width:60%}50%{width:100%}to{width:60%}}.ce-delimiter{line-height:1.6em;width:100%;text-align:center;background-image:url("+c+");background-position:50%;background-repeat:no-repeat;background-size:contain;height:100px}",""]),e.exports=t},329:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA+gAAAAeCAMAAACIXsRPAAAAmVBMVEUAAABnZ2cAAAAAAABGRkYAAAA0NDQaGhp2dnZ0dHRVVVV9fX17e3tiYmJsbGx8fHx7e3t8fHxycnJvb298fHx5eXl3d3dubm59fX0DAwMFBQVAQEAqKioAAAAICAgKCgoQEBAWFhYMDAw7OztVVVUbGxsNDQ1CQkI0NDQhISFjY2MnJydLS0stLS10dHReXl4vLy9tbW1HR0ck34UaAAAAGXRSTlMANgoEGAYSDnBgIOmiLD79r7dVTMGMe0fXvDJrsAAAAjZJREFUeNrt20dy4zAUBNBv5qwsG5A+AGZR2XP/w43oVDNbayEX3K8ILrhmF5oASAAAAAAAAAC/gOvTpzAkALCJT07ghP+GfRxIOoBF3HmWzV6m2Tp+Tny6CcaHBAAWcZ19aRQLrob6dTZPiMhHzAFs405KrrRmoZjVdr8KyPfeJ3YAsMfiokTVGcXKVELvLpFHI4cAwCLTQbXDSQkWklm2zdSjEO0dwDJPr+dVXCyvhoVWzGKzfCK4i0tvHFQjeDSX3I/X0Es8l5zFzrAQQmnJ7Yrg+0J6lztESVHkTwAPUxTpdJEnSRxN0myeL2b7klkKIZi16mOCO3hJSKNketltT1uAhziM49DxbjI5Hnolymu9a/njG53ZMO9R3u/s7d5zlM3OO83MAuBBpBSsZcUsuNMsNLM2UirJrIRQ0siI4I7qHk3607YzimVZVhLgAcTNeGcuTVUxy7egC/kZ9JuyQ3e/R7Fs6vpY9/2m3tTXDcDj1EPZLGf7umnL07H5c5Bf1V2zPAc4MHMXHCOGnyKaey5REGZZHJAfpV+LcZ05LrAr9E34HQh+FpfeBERe8ZwT5Z/ba1pdI8QcwDZ506fTbDJolpVk5mbtEwBYJlVsdMssdCe4GtKVRwBgF2fec6nl7ZKSuW1SxBzAOr53NrJjXQnBajimMd04WDEGsIrv7U8Ho9pyu7m8xA75mNABLOTkcbyOonUShJjIAezmeJQ4ROSHOCgDYKtgvP6HLTYAAAAAAPi+v0FpO0Tpc50UAAAAAElFTkSuQmCC"},331:function(e,t,n){var content=n(332);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(24).default)("c8ad95fe",content,!0,{sourceMap:!1})},332:function(e,t,n){(t=n(23)(!1)).push([e.i,'@keyframes skeleton-loading{0%{background-position:100% 50%}to{background-position:0 50%}}@-webkit-keyframes skeleton-loading{0%{background-position:100% 50%}to{background-position:0 50%}}@keyframes skeleton{0%{width:60%}50%{width:100%}to{width:60%}}@-webkit-keyframes skeleton{0%{width:60%}50%{width:100%}to{width:60%}}.cdx-checklist__item{display:-webkit-box;display:flex;box-sizing:content-box;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;-webkit-box-pack:start;justify-content:flex-start;-webkit-box-align:center;align-items:center}.cdx-checklist__item-text{-webkit-box-flex:1;flex:1;padding:10px 0;border-radius:0;border-bottom:1px solid #ebeef5}.cdx-checklist__item-checkbox{display:inline-block;flex-shrink:0;position:relative;width:20px;height:20px;margin:10px 10px 10px 0;border-radius:50%;border:1px solid #d0d0d0;background:#fff;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.cdx-checklist__item-checkbox:hover{border-color:#b5b5b5}.cdx-checklist__item-checkbox:after{position:absolute;top:5px;left:5px;width:8px;height:5px;border:2px solid #fcfff4;border-top:none;border-right:none;background:transparent;content:"";opacity:0;-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}.cdx-checklist__item--checked .cdx-checklist__item-checkbox{background:#ff6881;border-color:#ff6881}.cdx-checklist__item--checked .cdx-checklist__item-checkbox:hover{background:#ff6881}.cdx-checklist__item--checked .cdx-checklist__item-checkbox:after{opacity:1}',""]),e.exports=t},333:function(e,t,n){"use strict";"undefined"!=typeof window&&(Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(s){var e=this;if(!document.documentElement.contains(e))return null;do{if(e.matches(s))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null}))},334:function(e,t,n){var content=n(335);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(24).default)("775f1039",content,!0,{sourceMap:!1})},335:function(e,t,n){(t=n(23)(!1)).push([e.i,"@keyframes skeleton-loading{0%{background-position:100% 50%}to{background-position:0 50%}}@-webkit-keyframes skeleton-loading{0%{background-position:100% 50%}to{background-position:0 50%}}@keyframes skeleton{0%{width:60%}50%{width:100%}to{width:60%}}@-webkit-keyframes skeleton{0%{width:60%}50%{width:100%}to{width:60%}}.ce-paragraph{line-height:1.6em;outline:none}.ce-paragraph[data-placeholder]:empty:before{content:attr(data-placeholder);color:#707684;font-weight:400;opacity:0}.codex-editor--empty .ce-block:first-child .ce-paragraph[data-placeholder]:empty:before{opacity:1}.codex-editor--empty .ce-block:first-child .ce-paragraph[data-placeholder]:empty:focus:before,.codex-editor--toolbox-opened .ce-block:first-child .ce-paragraph[data-placeholder]:empty:before{opacity:0}.ce-paragraph p:first-of-type{margin-top:0}.ce-paragraph p:last-of-type{margin-bottom:0}",""]),e.exports=t},336:function(e,t,n){var content=n(337);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(24).default)("5603ac65",content,!0,{sourceMap:!1})},337:function(e,t,n){(t=n(23)(!1)).push([e.i,'@keyframes skeleton-loading{0%{background-position:100% 50%}to{background-position:0 50%}}@-webkit-keyframes skeleton-loading{0%{background-position:100% 50%}to{background-position:0 50%}}@keyframes skeleton{0%{width:60%}50%{width:100%}to{width:60%}}@-webkit-keyframes skeleton{0%{width:60%}50%{width:100%}to{width:60%}}.vote-wrap{border:1px solid rgba(201,201,204,.48);box-shadow:0 1px 3px rgba(0,0,0,.1);border-radius:6px;padding:15px 15px 15px 25px;margin:.7em 0;background-color:#fff}.vote-wrap p{position:relative;margin-bottom:10px;padding-left:10px;margin-left:2px;margin-top:10px}.vote-wrap p:before{content:"";position:absolute;left:0;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);height:14px;width:3px;background-color:#ff6881}.vote-wrap input{height:40px;line-height:40px;padding:0 10px;border-radius:0;border:none;border-bottom:1px solid #dcdfe6;min-width:100px}.vote-wrap-item{position:relative;height:40px;line-height:40px;display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;-webkit-box-align:center;align-items:center;padding:10px 0;box-sizing:content-box}.vote-wrap-item span{display:block;width:30px}.vote-wrap-item input{-webkit-box-flex:1;flex-grow:1}.vote-wrap-item div{position:absolute;right:-18px;top:10px;width:40px;height:40px;font-size:16px;text-align:center}.vote-wrap .append-btn-wrap{text-align:center}.vote-wrap .vote-append{display:inline-block;position:relative;width:24px;height:24px;line-height:24px;background-color:#ff6881;background-image:-webkit-gradient(linear,right top,left top,from(#ff869a),to(#ff6881));background-image:linear-gradient(-90deg,#ff869a,#ff6881);box-shadow:0 4px 8px 0 rgba(207,29,82,.16);color:#fff;border-radius:50%;margin-top:5px;font-weight:700}.vote-wrap footer .footer-item-wrap{margin-top:10px;display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;-webkit-box-pack:justify;justify-content:space-between;-webkit-box-align:center;align-items:center}',""]),e.exports=t},338:function(e){e.exports=JSON.parse('{"name":"smile","version":"1.0.0","description":"My breathtaking Nuxt.js project","author":"falstack","private":true,"scripts":{"lint":"eslint --fix --ext .js,.vue --ignore-path .gitignore .","precommit":"yarn lint","dev":"cross-env NODE_ENV=development nodemon server/index.js --watch server","build":"nuxt build","start":"cross-env NODE_ENV=production node server/index.js","analyze":"nuxt build --analyze","generate":"nuxt generate"},"dependencies":{"@calibur/sakura":"^1.0.16","@codexteam/ajax":"^4.1.0","@editorjs/checklist":"^1.1.0","@editorjs/delimiter":"^1.1.0","@editorjs/editorjs":"^2.16.1","@editorjs/embed":"^2.2.1","@editorjs/header":"^2.3.2","@editorjs/image":"^2.3.3","@editorjs/link":"^2.1.3","@editorjs/list":"^1.4.0","@nuxtjs/axios":"5.9.4","cross-env":"7.0.0","koa":"^2.11.0","nuxt":"2.11.0","url-polyfill":"^1.1.8","vue-mixin-store":"^1.2.0"},"devDependencies":{"@nuxtjs/eslint-config":"2.0.0","@nuxtjs/eslint-module":"1.1.0","@nuxtjs/style-resources":"^1.0.0","babel-eslint":"10.0.3","babel-plugin-component":"^1.1.1","core-js":"^3.6.4","eslint":"6.8.0","eslint-config-standard":"14.1.0","eslint-plugin-import":"2.20.0","eslint-plugin-jest":"23.6.0","eslint-plugin-node":"11.0.0","eslint-plugin-nuxt":"0.5.0","eslint-plugin-promise":"4.2.1","eslint-plugin-standard":"4.0.1","eslint-plugin-vue":"6.1.2","node-sass":"^4.13.1","nodemon":"2.0.2","qiniu-qupload":"^1.0.6","sass-loader":"^8.0.2"}}')},339:function(e,t,n){"use strict";var o=n(266);n.n(o).a},340:function(e,t,n){(t=n(23)(!1)).push([e.i,".editor-wrap .ce-paragraph{word-break:break-word!important;word-break:break-all}@keyframes skeleton-loading{0%{background-position:100% 50%}to{background-position:0 50%}}@-webkit-keyframes skeleton-loading{0%{background-position:100% 50%}to{background-position:0 50%}}@keyframes skeleton{0%{width:60%}50%{width:100%}to{width:60%}}@-webkit-keyframes skeleton{0%{width:60%}50%{width:100%}to{width:60%}}.editor-wrap{padding:0 10px}.editor-wrap .cdx-button{position:relative}.editor-wrap .image-tool__input{position:absolute;left:0;top:0;width:100%;height:100%;opacity:0}.editor-wrap .ce-block{font-weight:400;font-style:normal}.editor-wrap .ce-block a{display:none}.editor-wrap .ce-block__content{max-width:100%}.editor-wrap .ce-toolbar .ce-toolbox{visibility:visible;opacity:1}.editor-wrap .ce-toolbar .ce-toolbar__plus{display:none!important}.editor-wrap .ce-paragraph:before{color:silver!important}.ct--shown{display:none!important}",""]),e.exports=t},341:function(e,t,n){"use strict";var o=n(267),r=n.n(o);t.default=r.a},342:function(e,t,n){(t=n(23)(!1)).push([e.i,"@keyframes skeleton-loading_1qK55{0%{background-position:100% 50%}to{background-position:0 50%}}@-webkit-keyframes skeleton-loading_1qK55{0%{background-position:100% 50%}to{background-position:0 50%}}@keyframes skeleton_137i9{0%{width:60%}50%{width:100%}to{width:60%}}@-webkit-keyframes skeleton_137i9{0%{width:60%}50%{width:100%}to{width:60%}}.pin-draft_3apaf{padding:10px}.pin-draft_3apaf:not(:first-child){border-top:1px solid #ebeef5}.pin-draft_3apaf .poster_3ME69{height:75px;width:100px;border-radius:5px;margin-right:10px;border:1px solid #ebeef5;float:left}.pin-draft_3apaf .default-poster_2JmY1{-webkit-filter:grayscale(100%);filter:grayscale(100%);opacity:.3}.pin-draft_3apaf .body_uaEmQ{height:75px;overflow:hidden;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-pack:justify;justify-content:space-between;-webkit-box-align:start;align-items:flex-start}.pin-draft_3apaf .title_y3UjG{color:#505050;width:100%}",""]),t.locals={"pin-draft":"pin-draft_3apaf",pinDraft:"pin-draft_3apaf",poster:"poster_3ME69","default-poster":"default-poster_2JmY1",defaultPoster:"default-poster_2JmY1",body:"body_uaEmQ",title:"title_y3UjG","skeleton-loading":"skeleton-loading_1qK55",skeletonLoading:"skeleton-loading_1qK55",skeleton:"skeleton_137i9"},e.exports=t},343:function(e,t,n){"use strict";var o=n(268),r=n.n(o);t.default=r.a},344:function(e,t,n){(t=n(23)(!1)).push([e.i,"@keyframes skeleton-loading_3pCSN{0%{background-position:100% 50%}to{background-position:0 50%}}@-webkit-keyframes skeleton-loading_3pCSN{0%{background-position:100% 50%}to{background-position:0 50%}}@keyframes skeleton_3P9kH{0%{width:60%}50%{width:100%}to{width:60%}}@-webkit-keyframes skeleton_3P9kH{0%{width:60%}50%{width:100%}to{width:60%}}.bangumi-option_1VN2B{padding:10px 10px 0}.bangumi-option_1VN2B:not(:last-child) .body_3llvZ{border-bottom:1px solid #ebeef5}.bangumi-option_1VN2B .poster_3Wjvi{float:left;width:60px;height:60px;margin-right:10px;border:1px solid #ebeef5;border-radius:5px}.bangumi-option_1VN2B .body_3llvZ{overflow:hidden;height:70px;padding-bottom:10px;display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;-webkit-box-pack:justify;justify-content:space-between;-webkit-box-align:center;align-items:center}.bangumi-option_1VN2B .body_3llvZ .content_1f3Yk{-webkit-box-flex:1;flex:1;overflow:hidden}.bangumi-option_1VN2B .body_3llvZ .extra_1R6jg{margin-left:10px}",""]),t.locals={"bangumi-option":"bangumi-option_1VN2B",bangumiOption:"bangumi-option_1VN2B",body:"body_3llvZ",poster:"poster_3Wjvi",content:"content_1f3Yk",extra:"extra_1R6jg","skeleton-loading":"skeleton-loading_3pCSN",skeletonLoading:"skeleton-loading_3pCSN",skeleton:"skeleton_3P9kH"},e.exports=t},345:function(e,t,n){"use strict";var o=n(269);n.n(o).a},346:function(e,t,n){(t=n(23)(!1)).push([e.i,'@keyframes skeleton-loading{0%{background-position:100% 50%}to{background-position:0 50%}}@-webkit-keyframes skeleton-loading{0%{background-position:100% 50%}to{background-position:0 50%}}@keyframes skeleton{0%{width:60%}50%{width:100%}to{width:60%}}@-webkit-keyframes skeleton{0%{width:60%}50%{width:100%}to{width:60%}}#write-pin{position:relative;min-height:100vh;padding-bottom:60px}@media only screen and (device-width:375px) and (device-height:812px) and (-webkit-device-pixel-ratio:3){#write-pin{padding-bottom:80px}}@media only screen and (device-width:414px) and (device-height:896px) and (-webkit-device-pixel-ratio:2){#write-pin{padding-bottom:80px}}@media only screen and (device-width:414px) and (device-height:896px) and (-webkit-device-pixel-ratio:3){#write-pin{padding-bottom:80px}}#write-pin .title{position:relative}#write-pin .title:after{content:"";position:absolute;left:12px;right:12px;height:1px;background-color:#ebeef5}#write-pin .editor-wrap{border-bottom:1px solid #ebeef5}#write-pin .info-wrap{position:relative;padding:0 10px;z-index:1}#write-pin .info-wrap .info-title{padding:10px 0}#write-pin .footer{position:absolute;left:0;right:0;bottom:0;display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;-webkit-box-pack:space-evenly;justify-content:space-evenly;-webkit-box-align:center;align-items:center;height:50px;border-top:1px solid #ebeef5;z-index:1}@media only screen and (device-width:375px) and (device-height:812px) and (-webkit-device-pixel-ratio:3){#write-pin .footer{height:70px;padding-bottom:20px}}@media only screen and (device-width:414px) and (device-height:896px) and (-webkit-device-pixel-ratio:2){#write-pin .footer{height:70px;padding-bottom:20px}}@media only screen and (device-width:414px) and (device-height:896px) and (-webkit-device-pixel-ratio:3){#write-pin .footer{height:70px;padding-bottom:20px}}#write-pin .footer .v-button{-webkit-box-flex:1;flex:1;margin:0 5px}#write-pin .footer .v-button:first-child{margin-left:10px}#write-pin .footer .v-button:last-child{margin-right:10px}#write-pin .preload-wrap{display:none}',""]),e.exports=t},362:function(e,t,n){"use strict";n.r(t);n(35),n(54),n(55),n(265),n(32),n(57),n(104),n(105),n(76),n(34),n(58),n(33),n(36);var o=n(6),r=n(56),l=(n(312),n(53),n(314)),c=n.n(l),d=(n(225),n(226)),h=n.n(d),m=(n(236),n(237)),f=n.n(m),v=(n(43),n(10),n(25),n(109),n(26),n(49)),k=n(227),w=n(228),x=(n(235),n(40)),y=n(229),_=n(230),S=(n(315),function(){function e(t){var data=t.data,n=t.config,o=t.api;Object(y.a)(this,e),this.api=o,this._CSS={block:this.api.styles.block,settingsButton:this.api.styles.settingsButton,settingsButtonActive:this.api.styles.settingsButtonActive,wrapper:"ce-header"},this._settings=n,this._data=this.normalizeData(data),this.settingsButtons=[],this._element=this.getTag()}return Object(_.a)(e,[{key:"normalizeData",value:function(data){var e={};return"object"!==Object(x.a)(data)&&(data={}),e.text=data.text||"",e.level=parseInt(data.level)||this.defaultLevel.number,e}},{key:"render",value:function(){return this._element}},{key:"renderSettings",value:function(){var e=this,t=document.createElement("DIV");return this.levels.forEach((function(n){var o=document.createElement("SPAN");o.classList.add(e._CSS.settingsButton),e.currentLevel.number===n.number&&o.classList.add(e._CSS.settingsButtonActive),o.innerHTML=n.svg,o.dataset.level=n.number,o.addEventListener("click",(function(){e.setLevel(n.number)})),t.appendChild(o),e.settingsButtons.push(o)})),t}},{key:"setLevel",value:function(e){var t=this;this.data={level:e,text:this.data.text},this.settingsButtons.forEach((function(button){button.classList.toggle(t._CSS.settingsButtonActive,parseInt(button.dataset.level)===e)}))}},{key:"merge",value:function(data){var e={text:this.data.text+data.text,level:this.data.level};this.data=e}},{key:"validate",value:function(e){return""!==e.text.trim()}},{key:"save",value:function(e){return{text:e.innerHTML,level:this.currentLevel.number}}},{key:"getTag",value:function(){var e=document.createElement(this.currentLevel.tag);return e.innerHTML=this._data.text||"",e.classList.add(this._CSS.wrapper),e.contentEditable="true",e.dataset.placeholder=this._settings.placeholder||"",e}},{key:"onPaste",value:function(e){var content=e.detail.data,t=2;switch(content.tagName){case"H1":t=1;break;case"H3":t=3;break;case"H4":t=4;break;case"H5":t=5;break;case"H6":t=6}this.data={level:t,text:content.innerHTML}}},{key:"data",get:function(){return this._data.text=this._element.innerHTML,this._data.level=this.currentLevel.number,this._data},set:function(data){if(this._data=this.normalizeData(data),void 0!==data.level&&this._element.parentNode){var e=this.getTag();e.innerHTML=this._element.innerHTML,this._element.parentNode.replaceChild(e,this._element),this._element=e}void 0!==data.text&&(this._element.innerHTML=this._data.text||"")}},{key:"currentLevel",get:function(){var e=this,t=this.levels.find((function(t){return t.number===e._data.level}));return t||(t=this.defaultLevel),t}},{key:"defaultLevel",get:function(){return{number:2,tag:"H2"}}},{key:"levels",get:function(){return[]}}],[{key:"conversionConfig",get:function(){return{export:"text",import:"text"}}},{key:"sanitize",get:function(){return{level:{}}}},{key:"pasteConfig",get:function(){return{tags:["H1","H2","H3","H4","H5","H6"]}}},{key:"toolbox",get:function(){return{icon:'<svg width="11" height="14" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M7.6 8.15H2.25v4.525a1.125 1.125 0 0 1-2.25 0V1.125a1.125 1.125 0 1 1 2.25 0V5.9H7.6V1.125a1.125 1.125 0 0 1 2.25 0v11.55a1.125 1.125 0 0 1-2.25 0V8.15z"/></svg>',title:"标题"}}}]),e}()),C=(n(75),n(317),function(){function e(t){var data=t.data;Object(y.a)(this,e),this.data=data}return Object(_.a)(e,[{key:"render",value:function(){var e=document.createElement("div");e.classList.add("baidu-resource");var t=document.createElement("div");t.classList.add("baidu-resource-wrap"),e.appendChild(t);var n=document.createElement("input");n.classList.add("baidu-resource-url"),n.placeholder="仅支持百度云盘：pan.baidu.com",n.type="text",n.value=this.data&&this.data.url?this.data.url:"",t.appendChild(n);var o=document.createElement("input");o.classList.add("baidu-resource-password"),o.placeholder="填写资源的密码（4~6位）",o.type="text",o.value=this.data&&this.data.password?this.data.password:"",t.appendChild(o);var r=document.createElement("div");r.classList.add("baidu-resource-role-wrap");var l="".concat(Math.random().toString(36).substring(3,6)),c=this.data&&this.data.visit_type?this.data.visit_type:0,d=document.createElement("span");d.textContent="是否需要投食才能看到密码：",r.appendChild(d);var h=document.createElement("input");h.classList.add("baidu-resource-role-public"),h.id="baidu-resource-role-public-".concat(l),h.name=l,h.type="radio",h.value=0,h.checked=0===c,r.appendChild(h);var m=document.createElement("label");m.setAttribute("for","baidu-resource-role-public-".concat(l)),m.textContent="否",m.classList.add("baidu-resource-label"),r.appendChild(m);var f=document.createElement("input");f.classList.add("baidu-resource-role-private"),f.id="baidu-resource-role-private-".concat(l),f.type="radio",f.name=l,f.value=1,f.checked=1===c,r.appendChild(f);var v=document.createElement("label");return v.setAttribute("for","baidu-resource-role-private-".concat(l)),v.textContent="是",v.classList.add("baidu-resource-label"),r.appendChild(v),t.appendChild(r),e}},{key:"save",value:function(e){var t=e.querySelector(".baidu-resource-url"),n=e.querySelector(".baidu-resource-password"),o=e.querySelector(".baidu-resource-role-public"),r=t.value.trim();return/^https?:\/\//.test(r)||(r="https://"+r),{url:r,password:n.value.trim(),visit_type:o.checked?0:1}}},{key:"validate",value:function(e){return!(!e.url||!e.password)&&!(!/https?:\/\/pan\.baidu\.com\/s\/([\w\W]+)/.test(e.url)||!/^[\w|\W]{4,6}$/.test(e.password))}}],[{key:"toolbox",get:function(){return{title:"百度云",icon:'<svg version="1" xmlns="http://www.w3.org/2000/svg" width="28px" height="28px" viewBox="0 0 298 298" preserveAspectRatio="xMidYMid meet"><g stroke="none"><path d="M135.2 75.6c-11 2.9-20.1 9.5-26.5 19.1-5.1 7.6-7.4 14.6-8.4 24.5-.6 7.4.2 6.7-9.8 8.4-15.2 2.6-30.5 16.1-35.6 31.2-1.8 5.4-2 8.1-1.7 17.5.4 10.6.6 11.6 4.2 18.6 6.5 12.8 17.1 20.9 31.9 24.8 12.1 3.1 26.8.2 37.9-7.5 2.4-1.6 12.2-11.9 21.8-22.8 32.9-37.3 35.7-39.7 46.5-39.7 12.9.1 21.4 8.4 24 23.6.3 2.2 1.1 4.9 1.6 6.1 2.3 5.1 11.4 7.3 16.4 4 12.6-8.3-.4-41.6-19.8-50.8-5.8-2.7-16.1-5.6-20.1-5.6-2.4 0-2.6-.3-2.6-4.4 0-21.7-15.1-41.8-35.4-47.2-6.5-1.7-17.6-1.7-24.4.2zm19.4 21.9c5.7 1.7 12.8 8 15.2 13.5 1.9 4.5 1.8 14.5-.2 19.1-3.7 8.7-12.1 13.9-22.4 13.9-6.2 0-7.5-.4-11.8-3.3-7.4-4.9-10.7-10.4-11.2-18.3-.6-8.7 1.5-14.1 7.8-19.7 7.3-6.6 13.4-8 22.6-5.2zm-44.7 54.4c5 2.6 10.7 9.1 12 13.8 4.6 16.4-5.9 31.5-21.8 31.5-13.6.1-24.1-10-24.1-23.2 0-9.3 5.7-18.6 13.5-22.1 5.5-2.5 15.4-2.5 20.4 0zM225 200.7c-3.9 2.7-4.9 4.5-5 9 0 3.3.6 5 2.9 7.5 2.6 2.9 3.5 3.3 8.1 3.3s5.5-.4 8.1-3.3c6.4-7.2 2.1-18.2-7.3-18.2-2.5 0-5.4.7-6.8 1.7z"/></g></svg>'}}}]),e}()),E=(n(82),n(167),n(168),n(319),n(320),n(271),n(169),n(108),n(323),n(325)),j=(n(106),{bilibili:{regex:/https?:\/\/www\.bilibili\.com\/video\/av([\w\W]+)/,embedUrl:"//player.bilibili.com/player.html?aid=<%= remote_id %>",html:"<iframe width='100%' height='400' scrolling='no' border='0' frameborder='no' framespacing='0' allowtransparency='true' allowfullscreen='true'></iframe>",id:function(e){return e[0].split("/")[0].split("?")[0]}},bilih5:{regex:/https?:\/\/m\.bilibili\.com\/video\/av([\w\W]+)/,embedUrl:"//player.bilibili.com/player.html?aid=<%= remote_id %>",html:"<iframe width='100%' height='400' scrolling='no' border='0' frameborder='no' framespacing='0' allowtransparency='true' allowfullscreen='true'></iframe>",id:function(e){return e[0].split(".")[0].split("?")[0]}}}),A=function(){function e(t){var data=t.data,n=t.api;Object(y.a)(this,e),this.api=n,this._data={},this.element=null,this.data=data}return Object(_.a)(e,[{key:"render",value:function(){var t=this;if(!this.data.service){var n=document.createElement("div");return this.element=n,n}var html=e.services[this.data.service].html,o=document.createElement("div"),caption=document.createElement("div"),template=document.createElement("template"),r=document.createElement("div"),l=this.createPreloader();o.classList.add(this.CSS.baseClass,this.CSS.container,this.CSS.containerLoading),caption.classList.add(this.CSS.input,this.CSS.caption),o.appendChild(l),caption.contentEditable=!0,caption.dataset.placeholder="Enter a caption",caption.innerHTML=this.data.caption||"",template.innerHTML=html,template.content.firstChild.setAttribute("src",this.data.embed),template.content.firstChild.classList.add(this.CSS.content);var c=this.embedIsReady(o);return r.classList.add("editor-video-wrap"),r.appendChild(template.content.firstChild),o.appendChild(r),o.appendChild(caption),c.then((function(){o.classList.remove(t.CSS.containerLoading)})),this.element=o,o}},{key:"createPreloader",value:function(){var e=document.createElement("preloader"),t=document.createElement("div");return t.textContent=this.data.source,e.classList.add(this.CSS.preloader),t.classList.add(this.CSS.url),e.appendChild(t),e}},{key:"save",value:function(){return this.data}},{key:"onPaste",value:function(t){var n=t.detail,o=n.key,r=n.data,l=e.services[o],c=l.regex,d=l.embedUrl,h=l.width,m=l.height,f=l.id,v=void 0===f?function(e){return e.shift()}:f,k=c.exec(r).slice(1),embed=d.replace(/<\%\= remote\_id \%\>/g,v(k));this.data={service:o,source:r,embed:embed,width:h,height:m}}},{key:"embedIsReady",value:function(e){var t=null;return new Promise((function(n,o){(t=new MutationObserver(Object(E.a)(450,n))).observe(e,{childList:!0,subtree:!0})})).then((function(){t.disconnect()}))}},{key:"data",set:function(data){if(!(data instanceof Object))throw new TypeError("Embed Tool data should be object");var e=data.service,source=data.source,embed=data.embed,t=data.width,n=data.height,o=data.caption,caption=void 0===o?"":o;this._data={service:e||this.data.service,source:source||this.data.source,embed:embed||this.data.embed,width:t||this.data.width,height:n||this.data.height,caption:caption||this.data.caption||""};var r=this.element;r&&r.parentNode.replaceChild(this.render(),r)},get:function(){if(this.element){var caption=this.element.querySelector(".".concat(this.api.styles.input));this._data.caption=caption?caption.innerHTML:""}return this._data}},{key:"CSS",get:function(){return{baseClass:this.api.styles.block,input:this.api.styles.input,container:"embed-tool",containerLoading:"embed-tool--loading",preloader:"embed-tool__preloader",caption:"embed-tool__caption",url:"embed-tool__url",content:"embed-tool__content"}}}],[{key:"prepare",value:function(t){var n=t.config,o=(void 0===n?{}:n).services,r=void 0===o?{}:o,l=Object.entries(j),c=Object.entries(r).filter((function(e){var t=Object(v.a)(e,2),n=(t[0],t[1]);return"boolean"==typeof n&&!0===n})).map((function(e){return Object(v.a)(e,1)[0]})),d=Object.entries(r).filter((function(e){var t=Object(v.a)(e,2),n=(t[0],t[1]);return"object"===Object(x.a)(n)})).filter((function(t){var n=Object(v.a)(t,2),o=(n[0],n[1]);return e.checkServiceConfig(o)})).map((function(e){var t=Object(v.a)(e,2),n=t[0],o=t[1];return[n,{regex:o.regex,embedUrl:o.embedUrl,html:o.html,height:o.height,width:o.width,id:o.id}]}));c.length&&(l=l.filter((function(e){var t=Object(v.a)(e,1)[0];return c.includes(t)}))),l=l.concat(d),e.services=l.reduce((function(e,t){var n=Object(v.a)(t,2),o=n[0],r=n[1];return o in e?(e[o]=Object.assign({},e[o],r),e):(e[o]=r,e)}),{}),e.patterns=l.reduce((function(e,t){var n=Object(v.a)(t,2),o=n[0],r=n[1];return e[o]=r.regex,e}),{})}},{key:"checkServiceConfig",value:function(e){var t=e.regex,n=e.embedUrl,html=e.html,o=e.height,r=e.width,l=e.id,c=t&&t instanceof RegExp&&n&&"string"==typeof n&&html&&"string"==typeof html;return c=(c=(c=c&&(void 0===l||l instanceof Function))&&(void 0===o||Number.isFinite(o)))&&(void 0===r||Number.isFinite(r))}},{key:"pasteConfig",get:function(){return{patterns:e.patterns}}}]),e}(),L=(n(326),function(){function e(t){var data=t.data,n=(t.config,t.api);Object(y.a)(this,e),this.api=n,this._CSS={block:this.api.styles.block,wrapper:"ce-delimiter"},this._data={},this._element=this.drawView(),this.data=data}return Object(_.a)(e,null,[{key:"contentless",get:function(){return!0}}]),Object(_.a)(e,[{key:"drawView",value:function(){var div=document.createElement("DIV");return div.classList.add(this._CSS.wrapper,this._CSS.block),div}},{key:"render",value:function(){return this._element}},{key:"save",value:function(e){return{}}}],[{key:"toolbox",get:function(){return{icon:'<svg width="19" height="4" viewBox="0 0 19 4" xmlns="http://www.w3.org/2000/svg"><path d="M1.25 0H7a1.25 1.25 0 1 1 0 2.5H1.25a1.25 1.25 0 1 1 0-2.5zM11 0h5.75a1.25 1.25 0 0 1 0 2.5H11A1.25 1.25 0 0 1 11 0z"/></svg>',title:"分割线"}}}]),e}()),O=(n(78),n(330),n(242)),D=(n(331),n(333),function(){function e(t){var data=t.data,n=(t.config,t.api);Object(y.a)(this,e),this._elements={wrapper:null,items:[]},this._data={items:[]},this.api=n,this.data=data}return Object(_.a)(e,null,[{key:"enableLineBreaks",get:function(){return!0}},{key:"toolbox",get:function(){return{icon:'<svg width="15" height="15" viewBox="0 0 15 15" xmlns="http://www.w3.org/2000/svg"><path d="M7.5 15a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15zm0-2.394a5.106 5.106 0 1 0 0-10.212 5.106 5.106 0 0 0 0 10.212zm-.675-4.665l2.708-2.708 1.392 1.392-2.708 2.708-1.392 1.391-2.971-2.971L5.245 6.36l1.58 1.58z"/></svg>',title:"进度表"}}}]),Object(_.a)(e,[{key:"render",value:function(){var e=this;if(this._elements.wrapper=this._make("div",[this.CSS.baseBlock,this.CSS.wrapper]),this._data.items.length)this._data.items.forEach((function(t){var n=e.createChecklistItem(t);e._elements.items.push(n),e._elements.wrapper.appendChild(n)}));else{var t=this.createChecklistItem();this._elements.items.push(t),this._elements.wrapper.appendChild(t)}return this._elements.wrapper.addEventListener("keydown",(function(t){switch(t.keyCode){case 13:e.appendNewElement(t);break;case 8:e.backspace(t)}}),!1),this._elements.wrapper.addEventListener("click",(function(t){e.toggleCheckbox(t)})),this._elements.wrapper}},{key:"validate",value:function(e){return!!e.items.length}},{key:"toggleCheckbox",value:function(e){var t=e.target.closest(".".concat(this.CSS.item));t.querySelector(".".concat(this.CSS.checkbox)).contains(e.target)&&t.classList.toggle(this.CSS.itemChecked)}},{key:"createChecklistItem",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._make("div",this.CSS.item),n=this._make("span",this.CSS.checkbox),o=this._make("div",this.CSS.textField,{innerHTML:e.text?e.text:"",contentEditable:!0});return e.checked&&t.classList.add(this.CSS.itemChecked),t.appendChild(n),t.appendChild(o),t}},{key:"appendNewElement",value:function(e){e.preventDefault();var t=window.getSelection().anchorNode,n=this._elements.items[this._elements.items.length-1].querySelector(".".concat(this.CSS.textField)),o=n.innerHTML.replace("<br>"," ").trim();if(t===n&&!o)return this.api.blocks.insertNewBlock(),void e.stopPropagation();var r=this.createChecklistItem(),l=t.parentNode.closest(".".concat(this.CSS.item));this._elements.wrapper.insertBefore(r,l.nextSibling);var c=this._elements.items.indexOf(l)+1;this._elements.items.splice(c,0,r),this.moveCaretToEnd(r.querySelector(".".concat(this.CSS.textField)))}},{key:"backspace",value:function(e){var t=e.target.closest(".".concat(this.CSS.item)),n=this._elements.items.indexOf(t),o=t.querySelector(".".concat(this.CSS.textField)).innerHTML.replace("<br>"," ").trim();this._elements.items[0].querySelector(".".concat(this.CSS.textField)).innerHTML.replace("<br>"," ").trim()&&n&&!o&&(e.preventDefault(),t.remove(),this._elements.items.splice(n,1),"undefined"!==this._elements.items[n-1]&&this.moveCaretToEnd(this._elements.items[n-1].querySelector(".".concat(this.CSS.textField))))}},{key:"save",value:function(){return this.data}},{key:"_make",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=document.createElement(e);Array.isArray(n)?(t=r.classList).add.apply(t,Object(O.a)(n)):n&&r.classList.add(n);for(var l in o)r[l]=o[l];return r}},{key:"moveCaretToEnd",value:function(element){var e=document.createRange(),t=window.getSelection();e.selectNodeContents(element),e.collapse(!1),t.removeAllRanges(),t.addRange(e)}},{key:"CSS",get:function(){return{baseBlock:this.api.styles.block,wrapper:"cdx-checklist",item:"cdx-checklist__item",itemChecked:"cdx-checklist__item--checked",checkbox:"cdx-checklist__item-checkbox",textField:"cdx-checklist__item-text"}}},{key:"data",set:function(e){this._data.items=e.items||[];var t=this._elements.wrapper;t&&t.parentNode.replaceChild(this.render(),t)},get:function(){this._data.items=[];for(var i=0;i<this._elements.items.length;i++){var e=this._elements.items[i].querySelector(".".concat(this.CSS.textField)).innerHTML.replace("<br>"," ").trim();e&&this._data.items.push({text:e,checked:this._elements.items[i].classList.contains(this.CSS.itemChecked)})}return this._data}}]),e}()),$=(n(334),function(){function e(t){var data=t.data,n=t.config,o=t.api;Object(y.a)(this,e),this.api=o,this._CSS={block:this.api.styles.block,wrapper:"ce-paragraph"},this.onKeyUp=this.onKeyUp.bind(this),this._placeholder=n.placeholder?n.placeholder:e.DEFAULT_PLACEHOLDER,this._data={},this._element=this.drawView(),/^<input /gi.test(data.text)&&(data={}),this.data=data}return Object(_.a)(e,null,[{key:"DEFAULT_PLACEHOLDER",get:function(){return""}}]),Object(_.a)(e,[{key:"onKeyUp",value:function(e){"Backspace"!==e.code&&"Delete"!==e.code||""===this._element.textContent&&(this._element.innerHTML="")}},{key:"drawView",value:function(){var div=document.createElement("DIV");return div.classList.add(this._CSS.wrapper,this._CSS.block),div.contentEditable=!0,div.dataset.placeholder=this._placeholder,div.addEventListener("keyup",this.onKeyUp),div}},{key:"render",value:function(){return this._element}},{key:"merge",value:function(data){this.data={text:this.data.text+data.text}}},{key:"validate",value:function(e){return!(""===e.text.trim()||/vanced issues found/.test(e.text))}},{key:"save",value:function(e){return{text:e.innerHTML}}},{key:"onPaste",value:function(e){this.data={text:e.detail.data.innerHTML}}},{key:"data",get:function(){return this._data.text=this._element.innerHTML,this._data},set:function(data){this._data=data||{},this._element.innerHTML=this._data.text||""}}],[{key:"conversionConfig",get:function(){return{export:"text",import:"text"}}},{key:"sanitize",get:function(){return{text:{br:!0}}}},{key:"pasteConfig",get:function(){return{tags:["P"]}}}]),e}()),B=(n(336),function(){function e(t){var data=t.data,n=t.api;Object(y.a)(this,e),this.data=data,this.api=n,this.i=0}return Object(_.a)(e,[{key:"render",value:function(){var e=this;if(!(document.querySelectorAll(".vote-wrap").length>0)){var t=document.createElement("div");t.classList.add("vote-wrap");var n=document.createElement("p");n.textContent="投票（文章发表后无法再修改）";var o=document.createElement("ul"),r=document.createElement("div");r.classList.add("vote-append","bili-font","ic_add");var l=function(text){var n=document.createElement("li"),label=document.createElement("span");label.textContent="".concat(++e.i,". ");var input=document.createElement("input");if(input.type="text",input.placeholder="请输入选项（20字以内）",text&&(input.value=("string"==typeof text?text:text.text)||""),input.maxLength=20,input.classList.add("vote-answer"),n.classList.add("vote-wrap-item"),n.appendChild(label),n.appendChild(input),e.i>2){var l=document.createElement("div");l.classList.add("bili-font","ic_input_close"),l.addEventListener("click",(function(){o.removeChild(n),e.i--,e.i<100&&(r.style.display="block");var l=t.querySelector(".vote-wrap-select-count");l&&(l.max=e.i,l.value-e.i>0&&(l.value=e.i))})),n.appendChild(l)}o.appendChild(n),input.focus()};r.addEventListener("click",(function(){l(),e.i>=100&&(r.style.display="none");var n=t.querySelector(".vote-wrap-select-count");n&&(n.max=e.i)}));t.appendChild(n),t.appendChild(o);var c=document.createElement("div");return c.classList.add("append-btn-wrap"),c.appendChild(r),t.appendChild(c),this.data&&this.data.items?this.data.items.forEach(l):(l(),l()),function(){var footer=document.createElement("footer"),n=document.createElement("span");n.textContent="可选个数";var o=document.createElement("input");o.type="number",o.classList.add("vote-wrap-select-count"),o.min=1,e.data&&e.data.max_select?o.value=e.data.max_select:o.value=1,o.max=e.i;var r=document.createElement("div");r.classList.add("footer-item-wrap"),r.appendChild(n),r.appendChild(o),footer.appendChild(r);var l=document.createElement("span");l.textContent="截止时间（可选）";var c=document.createElement("input");c.type="date",c.min=new Date(Date.now()+864e5).toISOString().split("T")[0],c.classList.add("vote-expire-input"),e.data&&e.data.expired_at&&(c.value=new Date(1e3*e.data.expired_at).toISOString().split("T")[0]);var d=document.createElement("div");d.classList.add("footer-item-wrap"),d.appendChild(l),d.appendChild(c),footer.appendChild(d),t.appendChild(footer)}(),t}this.api.notifier.show({message:"一篇文章只能包含一个投票",style:"error"})}},{key:"save",value:function(e){var t=e.querySelectorAll(".vote-answer"),n=[];[].forEach.call(t,(function(e){n.push(e.value)}));var o=e.querySelector(".vote-expire-input");return{items:n.map((function(e){return e.trim()})).filter((function(e){return e})),right_ids:[],max_select:+e.querySelector(".vote-wrap-select-count").value,expired_at:o&&o.value?parseInt(new Date(o.value).getTime()/1e3):0}}},{key:"validate",value:function(e){return e.items.length>1}}],[{key:"toolbox",get:function(){return{title:"投票",icon:'<svg version="1" xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 300 298" preserveAspectRatio="xMidYMid meet"><g stroke="none"><path d="M109.5 62.4l-2.5 2.5v140.2l2.5 2.4c2.3 2.4 3 2.5 14.7 2.5 6.8 0 13.3-.3 14.6-.6 5.2-1.4 5.2-.8 5.2-75.1 0-66.3-.1-68.9-2-71.3-1.8-2.4-2.3-2.5-15.9-2.8-13.9-.3-14.1-.3-16.6 2.2zM50.2 100l-2.2 2.1v103.8l2.6 2c2.4 1.9 4 2.1 15 2.1 13.8 0 16.8-.9 18.4-5.3 1.4-4.2 1.4-97.3-.1-101.6-.6-1.7-1.9-3.6-2.9-4.1-1-.6-7.9-1-15.2-1-12.1 0-13.6.2-15.6 2zM230.4 109.4c-1.7.8-3.4 2.1-3.8 3.1-.3.9-.6 22.1-.6 47.1v45.5l2.5 2.4c2.3 2.4 3 2.5 14.9 2.5 14 0 17-.9 18.6-5.3 1.5-4.3 1.4-86.3-.1-90.7-.8-2.2-2.2-3.7-4.5-4.6-4.4-1.8-22.7-1.8-27 0zM170.3 158.2c-1.2.6-2.7 2.4-3.2 4.1-1.4 3.9-1.4 38.5-.1 42.4 1.6 4.4 4.6 5.3 18.6 5.3 11.9 0 12.6-.1 14.9-2.5 2.5-2.4 2.5-2.4 2.5-24s0-21.6-2.5-24c-2.3-2.4-2.9-2.5-15.2-2.4-7 0-13.8.5-15 1.1zM49.2 223.2c-1.9 1.9-1.5 6.6.7 7.8 1.3.7 36 1 105.3 1 84.4 0 103.8-.2 105.2-1.3 2.2-1.6 2.5-6.5.5-7.8-2.3-1.4-210.3-1.1-211.7.3z"/></g></svg>'}}}]),e}()),T=n(338),M={name:"JsonEditor",mixins:[k.a],props:{value:{required:!0,type:Array},slug:{type:String,default:""}},data:function(){return{editor:null}},mounted:function(){this.initEditor()},methods:{initEditor:function(){var e=this;Promise.all([n.e(29).then(n.t.bind(null,360,7)),n.e(28).then(n.bind(null,381)),Promise.all([n.e(26),n.e(27)]).then(n.bind(null,361))]).then((function(t){var data,n=e;n.slug?data={blocks:n.value,time:Date.now(),version:n.$cache.get("editor_version",T.dependencies["@editorjs/editorjs"].replace("^",""))}:(data=n.$cache.get("editor_local_draft"))&&n.$emit("input",data.blocks);var o=t.map((function(e){return e.default})),r=Object(v.a)(o,3),l=r[0],c=r[1],d=r[2],h=new l({data:n.decodeData(data||{}),holder:"codex-editor",placeholder:"请输入正文（建议在15000字以内）",autofocus:!1,tools:{video:{class:A,inlineToolbar:!0},header:{class:S,inlineToolbar:!0},image:{class:c,types:"image/jpeg, image/png, image/jpg",config:{uploader:{uploadByFile:function(e){return new Promise((function(t,o){var r=new FormData;r.append("file",e),r.append("token",n.imageUploadToken),Object(w.b)(n,r).then((function(data){data.url="https://m1.calibur.tv/".concat(data.url),t({success:1,file:data})})).catch(o)}))}}}},link:{class:d,config:{endpoint:"".concat("https://api.calibur.tv/","v1/pin/editor/fetch_site")}},delimiter:{class:L},checklist:{class:D,inlineToolbar:!0},baidu:{class:C},paragraph:{class:$},vote:{class:B}},onChange:function(){n.handleSave()}});h.isReady.then((function(){e.editor=h,e.bindSaveEvent(),e.handleSave()})).catch((function(t){e.$toast.error("编辑器初始化失败：".concat(t))}))}))},bindSaveEvent:function(){var e=this;document.addEventListener("keydown",(function(t){83===t.keyCode&&(t.ctrlKey||t.metaKey)&&(t.stopPropagation(),t.preventDefault(),e.handleSave())}),!1)},handleSave:function(){var e=this;this.editor&&this.editor.save().then((function(t){var n=e.encodeData(t);e.slug||(e.$cache.set("editor_local_draft",n),e.$cache.set("editor_version",n.version)),e.value&&e.$emit("input",n.blocks),e.$emit("save")})).catch((function(){e.$toast.error("保存失败")}))},decodeData:function(e){var t=e.version,n=e.blocks,time=e.time;return n?(n.forEach((function(e,t){"music"===e.type&&(n[t].type="video")})),{version:t,blocks:n,time:time}):null},encodeData:function(e){var t=e.version,n=e.blocks,time=e.time;return n.forEach((function(e,t){"video"===e.type&&e.data.service.startsWith("netease")&&(n[t].type="music",n[t].data.embed=n[t].data.embed.replace(/&amp;/g,"&"))})),{version:t,blocks:n,time:time}}}},V=(n(339),n(31)),H=Object(V.a)(M,(function(){var e=this.$createElement;this._self._c;return this._m(0)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"editor-wrap"},[t("div",{staticClass:"mousetrap",attrs:{id:"codex-editor"}})])}],!1,null,null,null).exports,U=n(234),P={name:"PinDraftItem",props:{item:{type:Object,required:!0}},computed:{noPoster:function(){return!this.item.title.banner}},methods:{handleClick:function(){this.$emit("click")}}},z=n(341);var N=Object(V.a)(P,(function(){var e,t=this,n=t.$createElement,o=t._self._c||n;return o("div",{class:t.$style.pinDraft,on:{click:t.handleClick}},[o("img",{class:[t.$style.poster,(e={},e[t.$style.defaultPoster]=t.noPoster,e)],attrs:{src:t.$resize(t.noPoster?"default-poster":t.item.title.banner.url,{width:200,height:150})}}),t._v(" "),o("div",{class:t.$style.body},[o("div",{staticClass:"oneline",class:t.$style.title,domProps:{textContent:t._s(t.item.title.text)}}),t._v(" "),o("p",{class:t.$style.time,domProps:{textContent:t._s(t.$utils.timeAgo(t.item.last_edit_at))}})])])}),[],!1,(function(e){this.$style=z.default.locals||z.default}),null,null).exports,R=(n(239),n(241)),I={name:"BangumiOptionItem",components:{VRadio:n.n(R).a},props:{item:{type:Object,required:!0},type:{type:String,default:"follow"},selectedSlug:{type:String,default:""}},data:function(){return{isSelected:this.item.slug===this.selectedSlug}},methods:{handleClick:function(){"select"===this.type&&this.$emit("click")}}},F=n(343);var J=Object(V.a)(I,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:e.$style.bangumiOption,on:{click:e.handleClick}},[n("img",{class:e.$style.poster,attrs:{src:e.$resize(e.item.avatar,{width:120,height:120})}}),e._v(" "),n("div",{class:e.$style.body},[n("div",{class:e.$style.content},[n("div",{staticClass:"oneline",class:e.$style.title,domProps:{textContent:e._s(e.item.name)}})]),e._v(" "),n("div",{class:e.$style.extra},["select"===e.type?n("VRadio",{attrs:{text:"",circle:"",readonly:""},model:{value:e.isSelected,callback:function(t){e.isSelected=t},expression:"isSelected"}}):e._e()],1)])])}),[],!1,(function(e){this.$style=F.default.locals||F.default}),null,null).exports;function K(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function Z(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?K(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):K(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var X={name:"WritePin",components:{VField:f.a,VButton:h.a,Editor:H,VDrawer:c.a,PinDraftItem:N,BangumiOptionItem:J},mixins:[U.a,k.a],asyncData:function(e){var t=e.app,n=e.error,o=e.query.slug;if(o)return t.$axios.$get("v1/pin/update/content",{params:{slug:o}}).then((function(data){return Z({},data)})).catch(n)},data:function(){return{slug:"",title:{banner:null,text:""},content:[],bangumi_slug:"",last_edit_at:"",published_at:"",selectedBangumi:null,loading:!1,renderEditor:!0,toggleDraftDrawer:!1,toggleBangumiDrawer:!1}},computed:{draftSource:function(){return this.$store.getters["flow/getFlow"]({func:"getUserDrafts",type:"page"})||{}},bangumiSource:function(){return this.$store.getters["flow/getFlow"]({func:"getUserBangumi",type:"page",query:{slug:this.currentUser.slug}})||{}}},mounted:function(){this.initCache(),this.initUserDraft(),this.initUserBangumi()},methods:{initCache:function(){this.slug||(this.$cache.has("editor_local_draft_title")&&(this.title=this.$cache.get("editor_local_draft_title")),this.$cache.has("editor_local_draft_bangumi")&&(this.selectedBangumi=this.$cache.get("editor_local_draft_bangumi"),this.selectedBangumi&&(this.bangumi_slug=this.selectedBangumi.slug)))},initUserDraft:function(){this.$refs.draftLoader&&this.$refs.draftLoader.initData()},initUserBangumi:function(){var e=this;this.$channel.$when("user-signed",Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.$refs.areaLoader){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.$refs.areaLoader.initData();case 4:e.bangumi_slug?e.selectedBangumi=e.bangumiSource.find((function(t){return t.slug===e.bangumi_slug})):e.selectedBangumi=e.bangumiSource.result[0],e.bangumi_slug=e.selectedBangumi.slug;case 6:case"end":return t.stop()}}),t)}))))},onEditorSave:function(){this.saveTitle(),this.saveBangumi()},saveTitle:function(){this.slug||this.$cache.set("editor_local_draft_title",this.title)},preValidate:function(){return!!this.loading||(this.title.text?this.content.length?(this.loading=!0,!1):(this.$toast.info("内容不能为空"),!0):(this.$toast.info("标题不能为空"),!0))},actionCreate:function(e){var t=this;this.preValidate()||this.$axios.$post("v1/pin/create/story",{bangumi_slug:this.bangumi_slug,content:[{type:"title",data:this.title}].concat(this.content),publish:e}).then((function(n){t.removeCache(),e?t.$bridge.redirectTo({url:"/pages/pin/show/index?slug=".concat(n)}):t.switchDraft(n),t.loading=!1})).catch((function(e){t.$toast.error(e.message),t.loading=!1}))},actionUpdate:function(e){var t=this;this.preValidate()||this.$axios.$post("v1/pin/update/story",{slug:this.slug,bangumi_slug:this.bangumi_slug,content:[{type:"title",data:this.title}].concat(this.content),publish:e}).then((function(n){e&&t.$bridge.redirectTo({url:"/pages/pin/show/index?slug=".concat(n)}),t.loading=!1})).catch((function(e){t.$toast.error(e.message),t.loading=!1}))},removeCache:function(){this.$cache.del("editor_local_draft_title"),this.$cache.del("editor_local_draft_bangumi"),this.$cache.del("editor_local_draft")},clearPageData:function(){var e=this;this.renderEditor=!1,this.slug="",this.title={banner:null,text:""},this.bangumi_slug="",this.last_edit_at="",this.published_at="",this.content=[],this.toggleDraftDrawer=!1,this.selectedBangumi=this.bangumiSource.result[0],this.$nextTick((function(){e.renderEditor=!0}))},updatePageData:function(data){var e=this;this.renderEditor=!1,this.slug=data.slug,this.title=data.title,this.last_edit_at=data.last_edit_at,this.published_at=data.published_at,this.bangumi_slug=data.bangumi_slug,this.content=data.content,this.toggleDraftDrawer=!1,this.bangumi_slug?this.selectedBangumi=this.bangumiSource.find((function(t){return t.slug===e.bangumi_slug})):this.selectedBangumi=this.bangumiSource.result[0],this.$nextTick((function(){e.renderEditor=!0}))},switchBangumi:function(e){this.toggleBangumiDrawer=!1,this.selectedBangumi=e,this.bangumi_slug=e.slug,this.saveBangumi()},saveBangumi:function(){this.$cache.set("editor_local_draft_bangumi",this.selectedBangumi)},switchDraft:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.slug)if(this.published_at){if(!n)return void this.$alert({title:"未对本次更改做保存",message:"切换后会丢失更新的内容，确认吗？",buttons:["取消","确认"],callback:function(n){n&&t.switchDraft(e,!0)}})}else this.actionUpdate(!1);this.$router.replace({name:this.$route.name,query:Z({},this.$route.query,{slug:e})}),e?this.$axios.$get("v1/pin/update/content",{params:{slug:e}}).then((function(data){t.updatePageData(data)})).catch((function(e){t.$toast.info(e.message)})):this.clearPageData()}},head:{title:"投稿"}},G=(n(345),Object(V.a)(X,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"write-pin"}},[n("div",{staticClass:"title"},[n("VField",{attrs:{"min-row":1,"max-row":2,"max-len":40,counter:"",placeholder:"标题（建议30字以内）"},model:{value:e.title.text,callback:function(t){e.$set(e.title,"text",t)},expression:"title.text"}})],1),e._v(" "),e.renderEditor?n("Editor",{attrs:{slug:e.slug},on:{save:e.onEditorSave},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}}):e._e(),e._v(" "),e.selectedBangumi?n("div",{staticClass:"info-wrap"},[n("p",{staticClass:"info-title"},[e._v("\n      请选择投稿分区\n    ")]),e._v(" "),n("VButton",{attrs:{plain:""},domProps:{textContent:e._s(e.selectedBangumi.name)},on:{click:function(t){e.toggleBangumiDrawer=!0}}})],1):e._e(),e._v(" "),n("div",{staticClass:"footer"},[e.published_at?[n("VButton",{attrs:{loading:e.loading},on:{click:function(t){return e.actionUpdate(!0)}}},[e._v("\n        更新文章\n      ")])]:[n("VButton",{attrs:{loading:e.loading},on:{click:function(t){return e.actionCreate(!0)}}},[e._v("\n        发布文章\n      ")]),e._v(" "),e.slug?n("VButton",{attrs:{loading:e.loading,theme:"info",plain:""},on:{click:function(t){return e.actionUpdate(!1)}}},[e._v("\n        存草稿\n      ")]):n("VButton",{attrs:{loading:e.loading,theme:"info",plain:""},on:{click:function(t){return e.actionCreate(!1)}}},[e._v("\n        存草稿\n      ")])],e._v(" "),e.draftSource.total?n("VButton",{attrs:{plain:""},on:{click:function(t){e.toggleDraftDrawer=!0}}},[e._v("\n      草稿箱("+e._s(e.draftSource.total)+")\n    ")]):e._e()],2),e._v(" "),n("div",{staticClass:"preload-wrap"},[n("FlowLoader",{ref:"draftLoader",attrs:{func:"getUserDrafts",type:"page",auto:0,query:{$axios:e.$axios}}}),e._v(" "),e.isAuth?n("FlowLoader",{ref:"areaLoader",attrs:{func:"getUserBangumi",type:"page",auto:0,query:{$axios:e.$axios,slug:e.currentUser.slug}}}):e._e()],1),e._v(" "),n("VDrawer",{model:{value:e.toggleDraftDrawer,callback:function(t){e.toggleDraftDrawer=t},expression:"toggleDraftDrawer"}},[n("FlowLoader",{attrs:{func:"getUserDrafts",type:"page",query:{$axios:e.$axios}},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.flow;return n("div",{},e._l(o,(function(t){return n("PinDraftItem",{key:t.slug,attrs:{item:t},on:{click:function(n){return e.switchDraft(t.slug)}}})})),1)}}])})],1),e._v(" "),n("VDrawer",{model:{value:e.toggleBangumiDrawer,callback:function(t){e.toggleBangumiDrawer=t},expression:"toggleBangumiDrawer"}},[n("FlowLoader",{attrs:{func:"getUserBangumi",type:"page",auto:0,query:{$axios:e.$axios,slug:e.currentUser.slug}},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.flow;return n("div",{},e._l(o,(function(t){return n("BangumiOptionItem",{key:t.slug,attrs:{item:t,"selected-slug":e.bangumi_slug,type:"select"},on:{click:function(n){return e.switchBangumi(t)}}})})),1)}}])})],1)],1)}),[],!1,null,null,null));t.default=G.exports}}]);