(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{245:function(e,t,n){},246:function(e,t,n){e.exports={"ic-sex":"ic-sex_19eCo",icSex:"ic-sex_19eCo","ic-level":"ic-level_3KuJr",icLevel:"ic-level_3KuJr","ic-title":"ic-title_Uq8in",icTitle:"ic-title_Uq8in"}},247:function(e,t,n){},253:function(e,t,n){"use strict";var r={name:"UserNickname",props:{user:{type:Object,required:!0},showSex:{type:Boolean,default:!1},showTitle:{type:Boolean,default:!1},showLevel:{type:Boolean,default:!1}},computed:{sexClass:function(){switch(this.user.sex){case-1:return{name:"simi",color:"limegreen"};case 0:return{name:"unknown",color:"gold"};case 1:return{name:"nan",color:"deepskyblue"};case 2:return{name:"nv",color:"hotpink"};default:return{name:"unknown",color:"gold"}}}},methods:{handleClick:function(){this.$emit("click")}}},o=(n(272),n(273)),l=n(37);var component=Object(l.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user-nickname",on:{click:e.handleClick}},[e.showTitle?e._l(e.user.title,(function(t,r){return n("span",{key:r,class:[e.$style.title,e.$style["ic-title"]],domProps:{textContent:e._s(t)}})})):e._e(),e._v(" "),e.showLevel?n("span",{class:[e.$style.title,e.$style["ic-level"]],domProps:{textContent:e._s("Lv"+e.user.level)}}):e._e(),e._v(" "),e.showSex?n("span",{class:e.$style["ic-sex"]},[n("i",{staticClass:"iconfont",class:"ic-"+e.sexClass.name,style:{backgroundColor:e.sexClass.color}})]):e._e(),e._v(" "),n("div",{staticClass:"name"},[n("p",{staticClass:"oneline",domProps:{innerHTML:e._s(e.user.nickname)}})])],2)}),[],!1,(function(e){this.$style=o.default.locals||o.default}),null,null);t.a=component.exports},254:function(e,t,n){"use strict";var r={name:"UserAvatar",props:{user:{type:Object,required:!0}},methods:{handleClick:function(){this.$emit("click")}}},o=(n(274),n(37)),component=Object(o.a)(r,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"user-avatar",on:{click:this.handleClick}},[t("img",{staticClass:"avatar",attrs:{src:this.$resizeImage(this.user.avatar,{width:30})}})])}),[],!1,null,null,null);t.a=component.exports},272:function(e,t,n){"use strict";var r=n(245);n.n(r).a},273:function(e,t,n){"use strict";var r=n(246),o=n.n(r);t.default=o.a},274:function(e,t,n){"use strict";var r=n(247);n.n(r).a},275:function(e,t,n){},299:function(e,t,n){"use strict";n(23);var r=n(5),o=(n(224),n(49),n(225)),l={name:"UserFollowBtn",components:{VButton:n.n(o).a},props:{slug:{type:String,required:!0}},computed:{state:function(){return this.$store.getters["social/get"]("user-follow",this.slug)},isAuth:function(){return this.$store.state.isAuth},isMine:function(){return this.$store.getters.isMine(this.slug)},btnStyle:function(){return this.isAuth&&this.state?this.isMine?{text:"自己",theme:"info",plain:!0}:this.state.is_following&&this.state.is_followed_by?{text:"已互粉",theme:"info",plain:!0,icon:"ic_more"}:this.state.is_following?{text:"已关注",theme:"info",plain:!0,icon:"ic_more"}:this.state.is_followed_by?{text:"关注我",theme:"primary",plain:!1,icon:"ic_add"}:{text:"关注",theme:"primary",plain:!1,icon:"ic_add"}:{text:"关注",plain:!1,theme:"primary",icon:"ic_add"}}},methods:{handleFollowClick:function(){var e=this;this.isAuth?this.isMine?this.$toast.info("不能关注自己"):this.state&&!this.state.is_following_loading&&("关注了我"!==this.btnStyle.text&&"关注"!==this.btnStyle.text?this.$alert({title:"提示",message:"确定要取消关注吗？",buttons:["取消","确定"],maskClose:!0,callback:function(t){t&&e.submit()}}):this.submit()):this.$channel.$emit("sign-in")},submit:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("social/toggle",{type:"user-follow",action:"is_following",slug:e.slug,params:{target_slug:e.slug,target_type:"user",method_type:"follow"}});case 2:(data=t.sent).success&&e.$emit("change",data.result);case 4:case"end":return t.stop()}}),t)})))()}}},c=n(37),component=Object(c.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.state?n("VButton",{attrs:{loading:e.state.is_following_loading,plain:e.btnStyle.plain,theme:e.btnStyle.theme,size:"small"},domProps:{textContent:e._s(e.btnStyle.text)},on:{click:e.handleFollowClick}}):e._e()}),[],!1,null,null,null);t.a=component.exports},317:function(e,t,n){"use strict";var r=n(275);n.n(r).a},376:function(e,t,n){"use strict";n.r(t);n(165),n(38),n(270),n(49);var r=n(271),o=n.n(r),l=n(299),c=n(253),h={name:"UserItem",components:{UserAvatar:n(254).a,UserNickname:c.a,UserFollowBtn:l.a},props:{user:{type:Object,required:!0},score:{type:String,default:""}},methods:{goUser:function(){this.$bridge.navigateTo({url:"/pages/user/show/index?slug=".concat(this.user.slug)})}}},f=(n(317),n(37)),d=Object(f.a)(h,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",{staticClass:"user-item",on:{click:e.goUser}},[n("UserAvatar",{attrs:{user:e.user}}),e._v(" "),n("div",{staticClass:"content"},[n("UserNickname",{attrs:{user:e.user}}),e._v(" "),n("p",{staticClass:"intro oneline",domProps:{textContent:e._s(e.score||e.user.signature)}})],1),e._v(" "),n("UserFollowBtn",{attrs:{slug:e.user.slug}})],1)}),[],!1,null,null,null).exports,m={name:"UserList",components:{VSwitcher:o.a,UserItem:d},data:function(){return{activeIndex:"user_followers"===this.$route.query.type?1:0}},computed:{query:function(){return this.$route.query},headers:function(){var e=this.query;return"idol_fans"===e.type?[{name:"最近入股",func:"getIdolFans",type:"page",query:{$axios:this.$axios,take:20,slug:e.slug,sort:"news"}},{name:"最多入股",func:"getIdolFans",type:"page",query:{$axios:this.$axios,take:20,slug:e.slug,sort:"hots"}}]:"user_following"===e.type||"user_followers"===e.type?[{name:"关注",func:"getUserRelation",type:"seenIds",query:{$axios:this.$axios,slug:e.slug,relation:"following",changing:"slug"}},{name:"粉丝",func:"getUserRelation",type:"seenIds",query:{$axios:this.$axios,slug:e.slug,relation:"follower",changing:"slug"}}]:[]}},methods:{handleChange:function(e){this.activeIndex=e,this.$refs.loader[e].initData()},computedUserScore:function(e,t){return"idol_fans"===this.query.type?"news"===t?this.$utils.timeAgo(e.list_score):"".concat(e.list_score,"股"):""},detectUserRelation:function(e){var t=this,n=e.data.result;n.length&&this.$axios.$get("v1/user/detect_relation",{params:{type:"user",targets:n.map((function(e){return e.slug})).join(",")}}).then((function(data){t.$store.commit("social/set",{type:"user-follow",data:data}),t.$refs.loader[t.activeIndex].patch(data)})).catch((function(){}))}},head:function(){return{title:"用户列表"}}},y=Object(f.a)(m,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"user-list"}},[e.headers.length?[n("VSwitcher",{attrs:{"default-index":e.activeIndex,headers:e.headers,align:"around"},on:{change:e.handleChange}},e._l(e.headers,(function(t,r){return n("FlowLoader",{key:r,ref:"loader",refInFor:!0,attrs:{slot:""+r,func:t.func,type:t.type,query:t.query,callback:e.detectUserRelation},slot:""+r,scopedSlots:e._u([{key:"default",fn:function(r){var o=r.flow;return n("ul",{},e._l(o,(function(r){return n("UserItem",{key:r.slug,attrs:{user:r,score:e.computedUserScore(r,t.query.sort)}})})),1)}}],null,!0)})})),1)]:n("FlowLoader",{attrs:{func:e.query.func,type:e.query.type,query:Object.assign({},{$axios:e.$axios},e.query),callback:e.detectUserRelation},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.flow;return n("ul",{},e._l(r,(function(t){return n("UserItem",{key:t.slug,attrs:{user:t,score:e.computedUserScore(t)}})})),1)}}])})],2)}),[],!1,null,null,null);t.default=y.exports}}]);