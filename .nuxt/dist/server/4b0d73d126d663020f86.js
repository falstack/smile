exports.ids=[21],exports.modules={134:function(t,e,n){var content=n(135);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals),n(3).default("1f568555",content,!0)},135:function(t,e,n){(e=n(2)(!1)).push([t.i,"@keyframes skeleton-loading{0%{background-position:100% 50%}to{background-position:0 50%}}@-webkit-keyframes skeleton-loading{0%{background-position:100% 50%}to{background-position:0 50%}}@keyframes skeleton{0%{width:60%}50%{width:100%}to{width:60%}}@-webkit-keyframes skeleton{0%{width:60%}50%{width:100%}to{width:60%}}.link-tool{position:relative}.link-tool__input{padding-left:38px;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='13' height='14' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M4.9 10.929a3.72 3.72 0 002.41.558l-.873.873a3.723 3.723 0 11-5.264-5.266L3.027 5.24a3.722 3.722 0 015.256-.008L6.817 6.7a5.209 5.209 0 01-.017.016 1.625 1.625 0 00-2.29.009L2.656 8.579a1.626 1.626 0 002.244 2.35zm2.766-7.358a3.722 3.722 0 00-2.41-.558l.873-.873a3.723 3.723 0 115.264 5.266L9.539 9.26a3.722 3.722 0 01-5.256.008L5.749 7.8a5.2 5.2 0 01.017-.016 1.625 1.625 0 002.29-.009L9.91 5.921a1.626 1.626 0 00-2.244-2.35z' fill='rgba(0, 0, 0, 0.6)'/%3E%3C/svg%3E\");background-repeat:no-repeat;background-position:15px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.link-tool__input-holder{position:relative}.link-tool__input-holder--error .link-tool__input{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='13' height='14' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M4.9 10.929a3.72 3.72 0 002.41.558l-.873.873a3.723 3.723 0 11-5.264-5.266L3.027 5.24a3.722 3.722 0 015.256-.008L6.817 6.7a5.209 5.209 0 01-.017.016 1.625 1.625 0 00-2.29.009L2.656 8.579a1.626 1.626 0 002.244 2.35zm2.766-7.358a3.722 3.722 0 00-2.41-.558l.873-.873a3.723 3.723 0 115.264 5.266L9.539 9.26a3.722 3.722 0 01-5.256.008L5.749 7.8a5.2 5.2 0 01.017-.016 1.625 1.625 0 002.29-.009L9.91 5.921a1.626 1.626 0 00-2.244-2.35z' fill='%23E09393'/%3E%3C/svg%3E\");background-color:#fff3f6;border-color:#f3e0e0;color:#a95a5a;box-shadow:inset 0 1px 3px 0 rgba(146,62,62,.05)}.link-tool__input[contentEditable=true][data-placeholder]:before{position:absolute;content:attr(data-placeholder);color:#707684;font-weight:400;opacity:0}.link-tool__input[contentEditable=true][data-placeholder]:empty:before{opacity:1}.link-tool__input[contentEditable=true][data-placeholder]:empty:focus:before{opacity:0}.link-tool__progress{position:absolute;box-shadow:inset 0 1px 3px 0 rgba(102,85,107,.04);height:100%;width:0;background-color:#f4f5f7;z-index:-1}.link-tool__progress--loading{-webkit-animation:progress .5s ease-in;-webkit-animation-fill-mode:forwards}.link-tool__progress--loaded{width:100%}.link-tool__content{display:block!important;padding:25px;border-radius:2px;box-shadow:0 0 0 2px #fff;color:#000!important;color:initial!important;text-decoration:none!important}.link-tool__content:after{content:\"\";clear:both;display:table}.link-tool__content--rendered{background:#fff;border:1px solid rgba(201,201,204,.48);box-shadow:0 1px 3px rgba(0,0,0,.1);border-radius:6px;will-change:filter;-webkit-animation:link-in .45s cubic-bezier(.215,.61,.355,1) 1;animation:link-in .45s cubic-bezier(.215,.61,.355,1) 1}.link-tool__content--rendered:hover{box-shadow:0 0 3px rgba(0,0,0,.16)}.link-tool__image{background-position:50%;background-repeat:no-repeat;background-size:cover;margin:0 0 0 30px;width:65px;height:65px;border-radius:3px;float:right}.link-tool__title{font-size:17px;font-weight:600;line-height:1.5em;margin:0 0 10px}.link-tool__title+.link-tool__anchor{margin-top:25px}.link-tool__description{margin:0 0 20px;font-size:15px;line-height:1.55em;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}.link-tool__anchor{display:block;font-size:15px;line-height:1em;color:#888!important;border:0!important;padding:0!important}@-webkit-keyframes link-in{0%{-webkit-filter:blur(5px);filter:blur(5px)}to{-webkit-filter:none;filter:none}}@keyframes link-in{0%{-webkit-filter:blur(5px);filter:blur(5px)}to{-webkit-filter:none;filter:none}}.codex-editor--narrow .link-tool__image{display:none}@-webkit-keyframes progress{0%{width:0}to{width:85%}}",""]),t.exports=e},136:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return l}));n(134),n(42);var o=n(38),r=n.n(o);class l{static get toolbox(){return{icon:'<svg width="13" height="14" xmlns="http://www.w3.org/2000/svg">\n  <path d="M8.567 13.629c.728.464 1.581.65 2.41.558l-.873.873A3.722 3.722 0 1 1 4.84 9.794L6.694 7.94a3.722 3.722 0 0 1 5.256-.008L10.484 9.4a5.209 5.209 0 0 1-.017.016 1.625 1.625 0 0 0-2.29.009l-1.854 1.854a1.626 1.626 0 0 0 2.244 2.35zm2.766-7.358a3.722 3.722 0 0 0-2.41-.558l.873-.873a3.722 3.722 0 1 1 5.264 5.266l-1.854 1.854a3.722 3.722 0 0 1-5.256.008L9.416 10.5a5.2 5.2 0 0 1 .017-.016 1.625 1.625 0 0 0 2.29-.009l1.854-1.854a1.626 1.626 0 0 0-2.244-2.35z" transform="translate(-3.667 -2.7)"/>\n</svg>',title:"超链接"}}static get enableLineBreaks(){return!0}constructor({data:data,config:t,api:e}){this.api=e,this.config={endpoint:t.endpoint||""},this.nodes={wrapper:null,container:null,progress:null,input:null,inputHolder:null,linkContent:null,linkImage:null,linkTitle:null,linkDescription:null,linkText:null},this._data={link:"",meta:{}},this.data=data}render(){return this.nodes.wrapper=this.make("div",this.CSS.baseClass),this.nodes.container=this.make("div",this.CSS.container),this.nodes.inputHolder=this.makeInputHolder(),this.nodes.linkContent=this.prepareLinkPreview(),Object.keys(this.data.meta).length?(this.nodes.container.appendChild(this.nodes.linkContent),this.showLinkPreview(this.data.meta)):this.nodes.container.appendChild(this.nodes.inputHolder),this.nodes.wrapper.appendChild(this.nodes.container),this.nodes.wrapper}save(){return this.data}set data(data){this._data=Object.assign({},{link:data.link||this._data.link,meta:data.meta||this._data.meta})}get data(){return this._data}get CSS(){return{baseClass:this.api.styles.block,input:this.api.styles.input,container:"link-tool",inputEl:"link-tool__input",inputHolder:"link-tool__input-holder",inputError:"link-tool__input-holder--error",linkContent:"link-tool__content",linkContentRendered:"link-tool__content--rendered",linkImage:"link-tool__image",linkTitle:"link-tool__title",linkDescription:"link-tool__description",linkText:"link-tool__anchor",progress:"link-tool__progress",progressLoading:"link-tool__progress--loading",progressLoaded:"link-tool__progress--loaded"}}makeInputHolder(){const t=this.make("div",this.CSS.inputHolder);return this.nodes.progress=this.make("label",this.CSS.progress),this.nodes.input=this.make("div",[this.CSS.input,this.CSS.inputEl],{contentEditable:!0}),this.nodes.input.dataset.placeholder="网页链接",this.nodes.input.addEventListener("paste",t=>{this.startFetching(t)}),this.nodes.input.addEventListener("keydown",t=>{const[e,n]=[13,65],o=t.ctrlKey||t.metaKey;switch(t.keyCode){case e:t.preventDefault(),t.stopPropagation(),this.startFetching(t);break;case n:o&&this.selectLinkUrl(t)}}),t.appendChild(this.nodes.progress),t.appendChild(this.nodes.input),t}startFetching(t){let e=this.nodes.input.textContent;"paste"===t.type&&(e=(t.clipboardData||window.clipboardData).getData("text")),this.removeErrorStyle(),this.fetchLinkData(e)}removeErrorStyle(){this.nodes.inputHolder.classList.remove(this.CSS.inputError),this.nodes.inputHolder.insertBefore(this.nodes.progress,this.nodes.input)}selectLinkUrl(t){t.preventDefault(),t.stopPropagation();const e=window.getSelection(),n=new Range,o=e.anchorNode.parentNode.closest(`.${this.CSS.inputHolder}`).querySelector(`.${this.CSS.inputEl}`);n.selectNodeContents(o),e.removeAllRanges(),e.addRange(n)}prepareLinkPreview(){const t=this.make("a",this.CSS.linkContent,{rel:"nofollow noindex noreferrer"});return this.nodes.linkImage=this.make("div",this.CSS.linkImage),this.nodes.linkTitle=this.make("div",this.CSS.linkTitle),this.nodes.linkDescription=this.make("p",this.CSS.linkDescription),this.nodes.linkText=this.make("span",this.CSS.linkText),t}showLinkPreview({image:image,title:title,description:t}){this.nodes.container.appendChild(this.nodes.linkContent),image&&image.url&&(this.nodes.linkImage.style.backgroundImage="url("+image.url+")",this.nodes.linkContent.appendChild(this.nodes.linkImage)),title&&(this.nodes.linkTitle.textContent=title,this.nodes.linkContent.appendChild(this.nodes.linkTitle)),t&&(this.nodes.linkDescription.textContent=t,this.nodes.linkContent.appendChild(this.nodes.linkDescription)),this.nodes.linkContent.classList.add(this.CSS.linkContentRendered),this.nodes.linkContent.setAttribute("href","javascript:;"),this.nodes.linkContent.appendChild(this.nodes.linkText);try{this.nodes.linkText.textContent=new URL(this.data.link).hostname}catch(t){this.nodes.linkText.textContent=this.data.link}}showProgress(){this.nodes.progress.classList.add(this.CSS.progressLoading)}hideProgress(){return new Promise(t=>{this.nodes.progress.classList.remove(this.CSS.progressLoading),this.nodes.progress.classList.add(this.CSS.progressLoaded),setTimeout(t,500)})}applyErrorStyle(){this.nodes.inputHolder.classList.add(this.CSS.inputError),this.nodes.progress.remove()}async fetchLinkData(t){if(t.includes(".")){/^https?:\/\//.test(t)||(t="https://"+t);try{new URL(t)}catch(t){return}this.showProgress(),this.data={link:t};try{const e=await r.a.get({url:this.config.endpoint,data:{url:t}});this.onFetch(e.body)}catch(t){this.fetchingFailed("服务暂时不可用")}}}onFetch(t){if(!t||!t.success)return void this.fetchingFailed("不支持的链接");const e=t.meta;this.data={meta:e},e?this.hideProgress().then(()=>{this.nodes.inputHolder.remove(),this.showLinkPreview(e)}):this.fetchingFailed("服务暂不可用")}fetchingFailed(t){this.api.notifier.show({message:t,style:"error"}),this.applyErrorStyle()}make(t,e=null,n={}){const o=document.createElement(t);Array.isArray(e)?o.classList.add(...e):e&&o.classList.add(e);for(const t in n)o[t]=n[t];return o}}}};